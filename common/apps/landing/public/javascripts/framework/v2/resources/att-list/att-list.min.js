define("element",["require","jquery"],function(e){var t=e("jquery"),n={},r={},i="_att_skin";return r.handle=function(e,r){var s=n[e];return s||(s=n[e]=t("#"+e+i)),r?s.find("[data-id="+r+"]"):s},r.forget=function(e){n[e]=undefined},r}),define("search",["require","jquery","./element"],function(e){function f(){var e,n=t(this).val();n&&(n=n.toLowerCase()),Object.keys(i).forEach(function(t){e=i[t];for(var r=0;r<a;r++)if(~e.identity[u[r]].indexOf(n))return l(t,!0);return l(t,!1)})}function l(e,t){var r=n.handle(e);t?r.show():r.hide();return}var t=e("jquery"),n=e("./element"),r={},i={},s={},o={},u=["displayName","email"],a=u.length;return r.init=function(e,n){o=n,s=e,i=s.get_users(),t("#atl-search input").attr("placeholder","Search a name or an email"),t("#atl-search input").on("keyup",f)},r.update=function(e){i=s.get_users()},r}),define("scroll",["require","jquery"],function(e){function s(e){var n=t(this),s=n.scrollTop(),o=r<s?Math.ceil:Math.floor;if(r==s)return;r=o(s/i)*i,n.scrollTop(r),r=n.scrollTop()}var t=e("jquery"),n={},r=0,i=1;return n.start=function(e){var t=e.find("li").height();i=t?t:"72",e.on("scroll",s)},n}),define("widget",["require","./search","./scroll"],function(e){function u(e){var t="/landing/images/user.svg",r;if(e.history){var i=$(e.history).get(-1);if(!i.joined)r="not known";else{var s=new Date(i.joined),o=s.getHours(),u=s.getMinutes();_hx=o>12?o-12:o,u=u<10?"0"+u:u,r=_hx+":"+u+(o<13?" am":" pm")}}e.avatar=e.photos?e.photos[0].value:null,e.time=r,e.email=e.emails?e.emails[0].value:"no email",e.att_id=e.vc_id+n,e.authvia=e.authvia||"not known"}var t=e("./search"),n="_att_skin",r={},i={},s={},o={};i.init=function(e,t,n,i){var u=$.Deferred();return o=i,s=$(e),r=t[1],u.resolve(),u.promise()},i.set_local_user=function(e,t){var n=t[0];u(e),s.append(n(e))},i.add_user=function(e){var n=$.Deferred();u(e);var i=r(e);return i||o.info("template creation failed"),$("#atl-list").append(i),t.update(),n.resolve(),n.promise()},i.toggle_visible=function(){s.toggle(),a&&a.ack()},i.remove_user=function(e){$("#"+e+n).remove(),t.update()};var a={ack:function(){e("./scroll").start($("#atl-list-wrap")),a=null}};return i}),define("controls",["require","jquery","./element"],function(e){function a(e){var n=t(this).closest("li").attr("id");if(!n)return r.info("warn:::user id not found...did someone change the user template?"),!1;var s=n.replace(u,""),a=t(this).attr("data-id"),f=a.replace("-slashed","");val=undefined,i[s]=i[s]||{};if(i[s][f]==="busy"||!i[s][f])return r.info("attempted to change while in 'busy/undef' state. Is a problem, control shouldn't be clickable"),!1;switch(a){case"microphone":val="false";break;case"microphone-slashed":val="true";break;case"camera":val="false";break;case"camera-slashed":val="true";break;default:r.info(f+" clicked____and is not handled");return}val&&(o.set_meta(s,f,val,!0),l(s,f,"busy")),r.info(s+" key: "+f+", to be val:"+val+", on_click")}function f(e,t,r){if(t=="audio-control"){var i=n.handle(e,t);i.css("width",r*100+"px");return}var s=n.handle(e,t),o=n.handle(e,t+"-slashed"),u=r?s:o,a=r?o:s;u.css("display","inline-block"),a.css("display","none")}function l(e,t,s){if(s!=="busy"&&s!=="set"){r.error("change_state: invalid state = ",s);return}var o=n.handle(e,t),u=n.handle(e,t+"-slashed"),a="att-state-"+s,f=s==="busy"?"att-state-set":"att-state-busy";o.addClass(a),o.removeClass(f),u.addClass(a),u.removeClass(f),i[e][t]=s;return}var t=e("jquery"),n=e("./element"),r={},i={},s={},o={},u="_att_skin";return s.init=function(e,n){var i=t.Deferred();return r=n,window.att_api=e,o=e,t("body").on("click","#atl-list .atl-control",a),i.resolve(),i.promise()},s.change=function(e,t,n){if(n!==!0&&n!==!1){r.error("controls.change: invalid value for val",n,'expected "true" or "false"');return}i[e]=i[e]||{};var s=i[e][t];f(e,t,n),l(e,t,"set");return},s.forget=function(e){i[e]=undefined,n.forget(e)},s}),define("listener",["require","events","./controls","./widget"],function(e){function a(e,t){switch(e){case"in":t.forEach(function(e){r.add_user(e)});break;case"out":r.remove_user(t),n.forget(t);break;case"control_changed":n.change(t.vc_id,t.known_key,t.value);break;default:u.info("some event: "+e+" @atl_skin, not my problem")}}var t=e("events"),n=e("./controls"),r=e("./widget"),i="framework:attendees",s="att-list",o={},u={};return o.init=function(e){u=e,t.bind(i,a,s)},o}),define("att-list",["require","jquery","framework","log","./widget","./controls","./search","./listener"],function(e){function c(e){t("#widget-attendees").toggle(),i.toggle_visible()}var t=e("jquery"),n=e("framework"),r=e("log")("att-list","info"),i=e("./widget"),s=e("./controls"),o=e("./search"),u=e("./listener"),a={},f=n.handle("att-list"),l=[];return a.init=function(e,n,a){var h=t.Deferred();if(!e.anchor||e.templates.length!=2)return h.reject("wrong info from backend"),h.promise();var p=e.anchor,d=t("#nav-attendees");return l.push(f.template(e.templates[0])),l.push(f.template(e.templates[1])),d.on("click",c),t(p).hide(),i.init(p,l,f.identity,r).then(s.init.bind(undefined,f.attendees,r),h.reject).then(o.init.bind(undefined,f.attendees,r),h.reject).then(h.resolve,h.reject),u.init(r),h.promise()},a.start=function(){i.set_local_user(t.extend(!0,f.identity),l);var e=f.attendees.get_users();Object.keys(e).forEach(function(n){i.add_user(t.extend(!0,e[n].identity))})},a}),require([""]);